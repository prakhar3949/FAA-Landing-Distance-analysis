---
title: "Project 3"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Multinomial Logistic Regression
## Using the Project 1 cleaned csv

```{r cars}
FAA_uniq <- read.csv("FAA_uniq.csv",header=TRUE, sep=",")
FAA_uniq$aircraft<-as.factor(FAA_uniq$aircraft)
levels(FAA_uniq$aircraft) <- c("airbus", "boeing")
FAA_pois <- FAA_uniq
```

## Step1: Creating a Multinomial Response Variable


```{r pressure, echo=FALSE}
FAA_uniq$dist.new <- ifelse(FAA_uniq$distance<1000,1,
                            ifelse(FAA_uniq$distance<2500,2,3))
FAA_uniq$distance <- NULL
FAA_uniq$dist.new<-as.factor(FAA_uniq$dist.new)
str(FAA_uniq)

```

## Check for Association


```{r}
library(dplyr)

egp<-group_by(FAA_uniq, aircraft, dist.new) %>% 
  summarise(count=n()) %>% group_by(aircraft) %>% 
  mutate(etotal=sum(count), proportion=count/etotal)

library("ggplot2")
par(mfrow=c(1,2))
ggplot(egp, aes(x=aircraft, y=proportion, group=dist.new, linetype=dist.new)) + geom_line()

```

* Airbus has a higher proportion of flights with landing distance < 1000 
* Boeing has a higher proportion of flights with landing distance in between 1000 and 2500
* Boeing has a higher proportion of flights with landing distance > 2500

**Hence, we can say that Boeing has a higher proportion of flights having landing distance > 1000 and Airbus has higher proportion of flights having shorter landing distances(<1000)**  


```{r}
#speed_ground
sggp<-mutate(FAA_uniq, sg_gp=cut_number(speed_ground,7)) %>% group_by(sg_gp, dist.new)%>% 
                summarise(count=n()) %>% group_by(sg_gp) %>% mutate(etotal=sum(count), 
                                                              proportion=count/etotal)

ggplot(sggp, aes(x=sg_gp, y=proportion, group=dist.new, linetype=dist.new)) + geom_line()

```

* With increase in speed_ground, proportion of flights with distance <1000 decreases steeply 
* Proportion of flights with medium distance (1000<distance<2500) increases with increase in speed_ground(uptil 91) and then decreases consistently
* Similarly, proportion of flights with distance >2500 increases sharply for higher speed_ground    


```{r}
par(mfrow=c(1,2))
#height
hgp<-mutate(FAA_uniq, h_gp=cut_number(height,7)) %>% group_by(h_gp, dist.new) %>% 
      summarise(count=n()) %>% group_by(h_gp) %>% mutate(etotal=sum(count), 
                                                         proportion=count/etotal)
ggplot(hgp, aes(x=h_gp, y=proportion, group=dist.new, linetype=dist.new)) + geom_line()

```

* With increase in height, the proportion of flights with medium distance(1000,2500) increases, while shorter distancesâ€™ proportion decreases.  

**This indicates that more height is preferred for fights having landing distances between 1000 and 2500**


```{r}
#pitch
pgp<-mutate(FAA_uniq, p_gp=cut_number(pitch,7)) %>% group_by(p_gp, dist.new) %>% 
      summarise(count=n()) %>% group_by(p_gp) %>% mutate(etotal=sum(count), 
                                                         proportion=count/etotal)
ggplot(pgp, aes(x=p_gp, y=proportion, group=dist.new, linetype=dist.new)) + geom_line()

```

* No consistent trend being followed in between the Pitch and the landing distances of the flights.  

**This indicates that Pitch might not be a significant factor in predicting the landing distance.**

## Step 3:Multiple Logistic Regression Model


```{r}
library(nnet)
final <- FAA_uniq
final$speed_air <- NULL
final <- na.omit(final)

modp <- multinom (dist.new ~ . ,final)
```

## Step 4: Variable Selection using AIC

```{r, results="hide"}
modp_AIC <- step(modp)
```

```{r}
summary(modp_AIC)
```


* We can see that the final model generated by the Step AIC function has 4 predictor variables(Aircraft, Speed_ground, height, pitch)
* The high standard error associated with Pitch confirms our previous observation that Pitch might not be highly assocaited with our reponse variable(dist.new)  


```{r}
modp_wp <- multinom(dist.new ~ aircraft + speed_ground + height, data=final)
summary(modp_wp)
```

## Final Model
* This proves our hypothesis and as AIC has increased insiginificantly, I have decided to keep my model simple and remove Pitch as a Predictor variable from my final model. 
* Final Model includes height, speed ground, and type of aircraft as the predictor variables with AIC as 421 and Residual Deviance as 405.
* The Coefficients can be interpreted as 

    + This fitted model says that, holding aircraft and height at a fixed value, the odds of medium distance (dist.new = 2) over the odds of smaller distance (dist.new = 1) is exp(.2411) = 1.27.  In terms of percent change, we can say that the odds of medium distance landing increases by 27% over smaller distance landing with every unit increase in speed_ground.
    + This fitted model says that, holding aircraft and height at a fixed value, the odds of larger distance (dist.new = 3) over the odds of smaller distance (dist.new = 1) is exp(1.1302) = 3.096.  In terms of percent change, we can say that the odds of larger distance landing increases by 209% over smaller distance landing with every unit increase in speed_ground.
\vspace{.5cm}
    + This fitted model says that, holding aircraft and speed_ground at a fixed value, the odds of medium distance (dist.new = 2) over the odds of smaller distance (dist.new = 1) is exp(.1523) = 1.16.  In terms of percent change, we can say that the odds of medium distance landing increases by 16% over smaller distance landing with every unit increase in height.
    + This fitted model says that, holding aircraft and height at a fixed value, the odds of larger distance (dist.new = 3) over the odds of smaller distance (dist.new = 1) is exp(.3728) = 1.451.  In terms of percent change, we can say that the odds of larger distance landing increases by 45% over smaller distance landing with every unit increase in height.
\vspace{.5cm}
    + This fitted model says that, holding speed_ground and height at a fixed value, the odds of medium distance (dist.new = 2) over the odds of smaller distance (dist.new = 1) is exp(3.885) = 48.666.  In terms of change, we can say that the odds of medium distance landing increases by 48 times over smaller distance landing with change in aircraft carrier to Boeing.
    + This fitted model says that, holding aircraft and height at a fixed value, the odds of larger distance (dist.new = 3) over the odds of smaller distance (dist.new = 1) is exp(8.794) = 6594.558.  In terms of change, we can say that the odds of larger distance landing increases by 6594 times over smaller distance landing with change in aircraft carrier to Boeing.
    
    
# Q2. Number of Passengers(Count Data) using Poisson 


```{r}
pois <- FAA_pois
pois$speed_air <- NULL
mod_psg<-glm(no_pasg ~ .,family=poisson,pois)
summary(mod_psg)
```

## Variable Selection using AIC


```{r}
mod_psgAIC <- step(mod_psg)
summary(mod_psgAIC)
```


```{r}
drop1(mod_psg,test="Chisq")
```

# Summary

* No variables are significant in the above model stating that number of passengers is not associated with any of the other variables.
* even using the likelihood ratio test results by dropping one variable at a time, we cannot conclude that the null hypothesis is rejected, null hypothesis being that the restricted model fits the data better

**Based on the above results, there are no useful variables for predicting number of passengers onboard.**